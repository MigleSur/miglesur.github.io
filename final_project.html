<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Final Project</title>

    <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script src="//d3js.org/topojson.v1.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="custom_range.js"></script>
    <script src="preprocess_map_data.js"></script>
    <script src="draw_legend.js"></script>
    <script src="draw_map.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="final_project.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="final_project.css">

</head>
<body>

<!-- Navbar (sit on top) -->
<div class="w3-top">
    <div class="w3-bar w3-white w3-card" id="myNavbar">
        <a href="#home" class="w3-bar-item w3-button w3-wide"></a>
        <!-- Right-sided navbar links -->
        <div class="w3-right w3-hide-small">
            <a href="#introduction" class="w3-bar-item w3-button">Introduction</a>
            <a href="#visualization1" class="w3-bar-item w3-button"> Discrimination in EU</a>
            <a href="#dataset" class="w3-bar-item w3-button"> Gender equality data set</a>
            <a href="#visualization2" class="w3-bar-item w3-button"> Gender equality index over time</a>
            <a href="#visualization3" class="w3-bar-item w3-button"> Gender equality index domains</a>
            <a href="#contributors" class="w3-bar-item w3-button"></i> Contributors</a>
        </div>
        <!-- Hide right-floated links on small screens and replace them with a menu icon -->

        <a href="javascript:void(0)" class="w3-bar-item w3-button w3-right w3-hide-large w3-hide-medium" onclick="w3_open()">
        </a>
    </div>
</div>


<!-- Header with full-height image -->
<header class="bgimg-1 w3-display-container w3-grayscale-min" id="home">
    <!--<div class="w3-center w3-large w3-text-black" style="padding:48px">The final project </div>-->
</header>

<!-- Introduction -->
<div class="w3-container w3-light-grey" style="padding:128px 16px" id="introduction">
    <h3 class="w3-center w3-xxlarge">Introduction</h3>
    <div class="w3-row-padding w3-justify w3-large" style="margin-top:64px">
        <div>
            Discrimination is the treatment of a person or particular group of people differently,
            in a way that is worse than the way people are usually treated. <a href="http://localhost:63342/miglesur.github.io/final_project.html?_ijt=969j3nqfv0lnq2ro89ju889okm#contributors">[1]</a> Unfortunately
            discrimination is widespread all over the world.
            In 2000 the European Union (EU) started fighting discrimination by adopting laws prohibiting such behaviour in
            the workplace based on racial or ethnic origin, religion or belief, disability, age, or sexual
            orientation. <a href="http://localhost:63342/miglesur.github.io/final_project.html?_ijt=969j3nqfv0lnq2ro89ju889okm#contributors">[2]</a>
            18 years after, there is still a need for improvement in order for
            discrimination not to be an issue in the EU anymore. <br> In this project we analyse
            the changes in discrimination over time in the EU with a deeper look in the gender inequality
            problem steeming from women discrimination. For this reason two data sets were used.
            The <a href="http://www.equineteurope.org/IMG/pdf/ebs_437_en.pdf">first one</a> is the discrimination data
            from the 2015 Eurobarometer survey asking citizens of EU state members about different types of
            discrimination and how widespread they are.
            The <a href="http://eige.europa.eu/sites/all/modules/custom/eige_gei/app/content/downloads/gender-equality-index-2005-2010-2012-2015.xlsx">second one</a>
            encodes the data collected by EU agencies reflecting six different aspects of life and their relation to gender inequality. These aspects are then summarised
            into a single parameter denominated Gender Equality Index (GEI).
            Data collection was performed in 4 different timepoints over a 10 years period. Thus, absolute values, together with changes in gender equality, are analysed in this report.
        </div>

    </div>
</div>


<!-- Visualization 1 -->
<div class="w3-container" style="padding:64px 16px" id="visualization1">
    <h3 class="w3-center w3-xxlarge">Discrimination rates in EU</h3>
    <div class="w3-row-padding w3-grayscale" style="margin-top:64px">
        <div class="w3-col w3-margin-bottom">
            <div class="w3-half">
                <div class="w3-container">
                    <svg  width="100%" height="500" id="barplot"><script>bar_plot(["widespread", "rare", "nonexistent", "dk"],
                        ["Widespread", "Rare", "Non-existent", "Don't know"],
                        ["#ffae4e","#ff682c","#c1000b","#9ba2c9"],
                        false)</script>
                    </svg>
                    <div class="w3-center">
                        <input type="button" id="discrimination-button" value="Widespread" onclick='bar_plot(add_column_list("widespread"), add_ann_list("Widespread"), add_color_list("#ffae4e"), true)'>
                        <input type="button" id="discrimination-button" value="Rare" onclick='bar_plot(add_column_list("rare"), add_ann_list("Rare"), add_color_list("#ff682c"), true)'>
                        <input type="button" id="discrimination-button" value="Non-existent" onclick='bar_plot(add_column_list("nonexistent"), add_ann_list("Non-existent"),add_color_list("#c1000b"), true)'>
                        <input type="button" id="discrimination-button" value="Don't know" onclick='bar_plot(add_column_list("dk"), add_ann_list("Don&#39;t know"),add_color_list("#9ba2c9"), true)'>
                        <input type="button" id="discrimination-button" value="Reset original" onclick='bar_plot(["widespread", "rare", "nonexistent", "dk"],
                            ["Widespread", "Rare", "Non-existent", "Don&#39;t know"],
                            ["#ffae4e","#ff682c","#c1000b","#9ba2c9"],
                            true), remove_all()'>

                    </div>
                </div>
            </div>
            <div class="w3-half w3-justify">
                <div class="w3-container" >
                    EU citizens were asked to fill a survey asking how widespread were different forms of discrimination.
                    As can be seen from the visualization, those most recognised were ethnic origin, sexual orientation and gender identity.
                    That may be a consequence of high attention levels these types of discrimination get in everyday life. Interestingly, most of the
                    respondents think that the least widespread discrimination is by age or gender. Notably, several respondents immediately
                    denied the existence of such kinds of discrimination. As much as 9% of the people identified gender discrimination as non-existent even if this
                    issue is often publicly addressed, and it is only discrimination by age that is denied more often.
                    The latter has less proof of being common in EU. In the further analysis it was decided to concentrate on the gender equality
                    issues in the EU and the main problems it must overcame in order to achieve gender equality.
                </div>
                <div class="w3-container">
                    In this visualization the reader is fully enabled to explore the data by analyzing one or a few survey answers without including the others.
                    The plot displays bars for every discrimination form and possible answer, and their height is mapped to the fraction of respondents answering the corresponding answer
                    with respect to the total for that form. The plot can be reset by pressing the "Reset original" button. Also, a tooltip helps identify the difference in percent between different columns
                    by displaying the percentage of respondents who chose the particular answer.
                </div>
            </div>
        </div>

    </div>
</div>



<!-- Introduction to data set -->
<div class="w3-container w3-center w3-light-grey w3-padding-64" id="dataset">
    <h3 class="w3-center w3-xxlarge">Gender equality data set</h3>
    <!--<p class="w3-large">The main idea of the visualization</p>-->
    <div class="w3-row-padding">
        <div class="w3-section w3-justify"">
            The gender equality index in the EU has been measured in four different years: 2005, 2010, 2012, 2015.
        As mentioned before, discrimination is hard to measure, in this study gender equality index was calculated after measuring six different domains of life:
        money, work, time, knowledge, power and health. Each of these domains have sub-domains
            which were measured in order to calculate the value of the specific domain.
        </div>
        <div class="w3-section w3-justify"">
            The calculations are made in a way that a score of 100 means that gender equality is achieved in the specific domain or in total, while 0 means complete
            inequality. More information about how gender equality index is calculated can be found <a href="https://www.google.dk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&uact=8&ved=0ahUKEwilzt3Dnt_YAhWKJ5oKHcXIBcsQFggyMAE&url=http%3A%2F%2Feige.europa.eu%2Fsites%2Fdefault%2Ffiles%2Fdocuments%2Fmh0415169enn.pdf&usg=AOvVaw3q7wreJ5GrPf7QT91IZDZx">here</a>.
            As mentioned before, each domain contains a few sub-domains. The <strong>Money</strong> domain contains data about earnings, income and economic
            situation. The <strong>Work</strong> domain - employment, duration of working life, sectoral segregation, flexibility of working hours and work intensity.
            The <strong>Knowledge</strong> domain - tertiary education, segregation and lifelong learning. <strong>Time</strong> childcare activities, domestic
            activities and social activities. The <strong>Power</strong> domain - political power, social power and economical power. The <strong>Health</strong> domain -
            health status and access to health care.
        </div>
        </div>
    </div>
</div>


<!-- Visualization 2 Section -->
<div class="w3-container w3-center w3-padding-64" id="visualization2">
    <h3 class="w3-center w3-xxlarge">Visualization 2</h3>
    <p class="w3-large">The main idea of the visualization</p>
    <div class="w3-row-padding">
        <div class="w3-third w3-justify">
            <p>
                The Overall Gender Equality, which summarizes the scores in all different domains, is remarkably heterogeneous across the different EU countries.
                However, a general trend for improvement is observed, as most countries increase their score in the 10-year period ranging from 2005 to 2015.
                In 2005, a clear distinction can be drawn between countries belonging to the Eastern Bloc in the XX century, and those that belonged to the West.
                Germany is the best example of this trend, as it stands both physically and socially in between both blocs after the 1989 reunification.
            </p>
            <p>
                As is the case of Germany, convergence between East and West has not been achieved. Contrary to what is happening in Germany, where the gap is decreasing,
                it seems to be growing at the EU level in terms of gender equality. Even though there's a general increase in equality, it
                is biggest in the Western countries, which manage to achieve scores above 70 (France, Netherlands, ...), whereas Hungary, the Czech Republic, ... experience very mild increases.
                This can be due to the fact that there still remains a more conservative society that is more reluctant to change. On the other hand, the Eastern countries only joined the EU in 2004
                (Romania and Bulgaria in 2007 and Croatia in 2013), which indicates that the long term positive effects that EU-membership could provide haven't had the time to make an impact.
            </p>
            <p>
                There's another main axis of variation, which corresponds to the North-South corridor. Traditional Western Bloc countries like Portugal, Spain, Italy and Greece
                exhibit a milder equality when compared to their other Western neighbours. This can be explained again by the existence of more traditional societies.
                However, the some of the biggest improvements in equality are also observed in these countries, particularly in Italy, which shows the greatest improvement
                of all EU members in the 2005-2015 period.
            </p>

            <p>
                The visualization enables the user to explore the growth of equality across the different EU countries by moving a time slider beneath the Europe map. The GEI score is mapped to
                5 buckets covering the whole 0-100 domain. This score is encoded by a red color scale with varying brightness. Hovering the mouse over a country switches its color to yellow
                and displays a tooltip featuring the country name, the GEI for that year, and the difference with respect to 2005.
            </p>



        </div>
        <div class="w3-twothird w3-section">
            <div class="map"><svg><g class="legend"></g></svg></div>
            <svg width="960" height="50"></svg>
            <script>
                var width = 960,
                    height = 960;
                var svg = d3.select("div.map").select("svg")
                    .attr("width", width)
                    .attr("height", height);
            </script>


            <script>
                var tooltip = d3.select(".map").append("div")
                    .attr("class", "tooltip")
                    .style("opacity", 0);

                var year = "2005";

                d3.csv("maps/active_countries.csv", function (error1, active_countries) {
                    if (error1) throw error1;

                    var dummy = [];
                    for (i = 0; i < active_countries.length; i++) {
                        dummy.push(active_countries[i]["x"]);
                    }

                    active_countries = dummy;

                    d3.json("maps/custom.json", function (error3, custom) {
                        if (error3) return console.error(error3);

                        var projection = d3.geo.albers()
                            .center([0, 48])
                            .rotate([-16, 0])
                            .parallels([35, 70])
                            .translate([width / 2, height / 2]);


                        // Add country path
                        var countries = topojson.feature(custom, custom.objects.countries);



                        var path = d3.geo.path()
                            .projection(projection);



                        // Add country name
                        var map = svg.append("g");

                        map
                            .selectAll(".country")
                            .data(countries.features)
                            .enter().append("path")
                            .attr("class", function (d) {
                                return "country " + d.id;
                            })
                            .attr("d", path);
                        // Display borders

                        map
                            .append("path")
                            .datum(topojson.mesh(custom, custom.objects.countries, function (a, b) {
                                return a !== b && (active_countries.indexOf(a.id) >= 0 ^ active_countries.indexOf(b.id) >= 0);
                            }))
                            .attr("d", path)
                            .attr("class", "exterior-boundary");

                        map.append("path")
                            .datum(topojson.mesh(custom, custom.objects.countries, function (a, b) {
                                return a !== b && active_countries.indexOf(a.id) >= 0 && active_countries.indexOf(b.id) >= 0;
                            }))
                            .attr("d", path)
                            .attr("class", "interior-boundary");


                        map.append("path")
                            .datum(topojson.mesh(custom, custom.objects.countries, function (a, b) {
                                return a === b && active_countries.indexOf(a.id) < 0 && active_countries.indexOf(b.id) < 0; //&&
                                // ["YF", "BA"].indexOf(a.id) < 0 && ["YF", "BA"].indexOf(b.id) < 0;
                            }))
                            .attr("d", path)
                            .attr("class", "coastline");


                        draw_legend();

                        var text = svg
                            .append("g")
                            .append("text")
                            .attr("class", "year_text");



                        draw_map(year, countries, active_countries);

                        var slider = svg.select("g.slider");

                        slider.call(d3.drag()
                            .on("start.interrupt", function () {
                                slider.interrupt();
                            })
                            .on("start drag", function () {
                                var new_year = hue(xslider.invert(d3.event.x));
                                if (year !== new_year) {
                                    year = new_year;
                                    draw_map(new_year, countries, active_countries);
                                }
                            }));


                    });
                });


            </script>
            <script src="https://d3js.org/d3.v4.min.js"></script>
            <script src="slider.js"></script>

        </div>  <!-- end of two third section  -->
    </div> <!-- end of row padding -->
</div> <!-- end of visualization 2 -->
</div>

<!-- Visualization 3 Section -->
<div class="w3-container  w3-light-grey" style="padding:64px 16px" id="visualization3">
    <h3 class="w3-center w3-xxlarge">Gender equality index and its domains in 2015</h3>
    <!--<p class="w3-large">The main idea of the visualization</p>-->
    <div class="w3-row-padding" style="margin-top:30px">
        <div class="w3-half w3-section">
            <!--<svg width="600" height="550" id="chart"> <script>radar_chart("gei2015overall.json")</script>  </svg>-->
            <input type="button" id="radar-button" value="Overall" title="Overall gender equality index values in EU" onclick="updateOverall()">
            <input type="button" id="radar-button" value="Money" title="Earnings, income, economic situation" onclick="updateMoney()">
            <input type="button" id="radar-button" value="Work" title="Participation, duration of working life, sectoral segregation, quality of work" onclick="updateWork()">
            <input type="button" id="radar-button" value="Knowledge" title="Tertiary education, segregation, lifelong learning" onclick="updateKnowledge()">
            <input type="button" id="radar-button" value="Time" title="Childcare, domestic activities, social activities" onclick="updateTime()">
            <input type="button" id="radar-button" value="Power" title="Political, social, economic power" onclick="updatePower()">
            <input type="button" id="radar-button" value="Health" title="Life expectancy, healthy life years, access to medical needs" onclick="updateHealth()">
            <div class="w3-row-padding" style="margin-top:30px"> <svg width="600" height="500" id="radarchart"> <script>drawRadarCharts()</script> </svg> </div>
        </div>
        <div class="w3-half w3-justify">
            <div class="w3-container">
                The overall gender equality index shows big differences between different parts of Europe. For example, it is easy to notice that Scandinavia and
                the Western European countries are more advanced in gender equality than the rest of EU countries (South-West, Central, Eastern, South-East and South).
                A similar tendency can be observed by looking at the <strong>Money</strong> domain or the <strong>Knowledge</strong> domain. While in the <strong>Work</strong>
                domain the difference between countries is pretty small and all the EU countries have a <strong>Work</strong> domain score pretty mediocre.
                The <strong>Time</strong> domain doesn't have a strong pattern but there is still a slight difference between the Western Europe with Scandinavia and the rest of the EU.
                The <strong>Power</strong> domain is in the worst situation and all of the countries have a really low score for this domain. While it is slightly higher in Scandinavia and Western
                European countries, in some countries the situation is critical as the score for <strong>Power</strong> is close to 20. In the <strong>Health</strong>
                domain all the EU countries are very advanced and perform very similarly. In conclusion, even if gender equality differs in EU countries, every
                country still has room for improvement.
            </div>
            <div class="w3-container">
                In this visualization the reader is enabled to explore different domains of gender equality index in EU countries. As the countries are clustered by regions, it
                becomes easier to analyze the differences in different regions of Europe. In order to quickly find out what each domain represents it is enough to
                hover over the button of the particular domain.
            </div>
        </div>
    </div>
</div>


<!-- Contributors Section -->
<div class="w3-container " style="padding:128px 16px" id="contributors">
    <h3 class="w3-center">Contributors</h3>
    <p class="w3-center w3-large">The project was done by Antonio Ortega Jimenez and Miglė Survilaite.</p>
    <p class="w3-center w3-large">The word map was taken from <a href="https://www.thekrine.com/blog/">here</a>.</p>
    <p class="w3-center w3-large">The code for the radar chart was adopted from <a href="https://bl.ocks.org/alandunning/4c36eb1abdb248de34c64f5672afd857">here</a>.</p>
    <p class="w3-center w3-large">The code to build the map of Europe was taken from Mike Bostock's tutorial <a href="https://bost.ocks.org/mike/map/">here</a>.</p>
    <p class="w3-center w3-large">The cartographic data serving the country shapes was fetched from <a href="http://www.naturalearthdata.com/http//www.naturalearthdata.com/download/10m/cultural/ne_10m_admin_0_map_subunits.zip
    ">Natural Earth</a>.</p>
    
    <p class="w3-center w3-large">[1] <a href="https://dictionary.cambridge.org/dictionary/english/discrimination?a=american-english">Definition of discrimination</a>
        Cambridge Dictionaries Online. Cambridge University.</p>
    <p class="w3-center w3-large">[2] <a href="http://www.equineteurope.org/IMG/pdf/ebs_437_en.pdf">
        Discrimination in the EU in 2015</a> Eurobarometer Report.</p>
    <div class="w3-row-padding" style="margin-top:64px">
        <div class="w3-half">

        <div class="w3-half">

        </div>
    </div>
</div>

<!-- Footer -->
<footer class="w3-center w3-black w3-padding-64">
    <a href="#home" class="w3-button w3-light-grey"><i class="fa fa-arrow-up w3-margin-right"></i>To the top</a>
    <!--<div class="w3-xlarge w3-section">-->
    <!--</div>-->
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" title="W3.CSS" target="_blank" class="w3-hover-text-green">w3.css</a></p>
</footer>

    <!--https://www.w3schools.com/w3css/tryit.asp?filename=tryw3css_templates_startup-->
</body>
</html>